# ============================================================
# Docker Compose Override for Development
# ============================================================
# This file provides development-specific configurations
# Copy this to docker-compose.override.yml to use it
# ============================================================

version: '3.8'

services:
  # Development configuration for app container
  app:
    # Build with no cache for development
    build:
      context: .
      dockerfile: Dockerfile
      cache_from: []
    
    # Override command to keep container running
    command: tail -f /dev/null
    
    # Environment variables for development
    environment:
      DB_HOST: mariadb
      DB_USER: root
      DB_PASS: root_password
      DB_NAME: movies_db
      PYTHONUNBUFFERED: 1
      DEBUG: 1
    
    # Mount source code for live editing
    volumes:
      - .:/app
      - ./logs:/app/logs
    
    # Keep stdin open for interactive debugging
    stdin_open: true
    tty: true

  # Development configuration for MariaDB
  mariadb:
    # Expose more ports for debugging
    ports:
      - "3306:3306"
    
    # Mount custom configuration
    volumes:
      - mariadb_data:/var/lib/mysql
      - ./1_create_schema.sql:/docker-entrypoint-initdb.d/01_create_schema.sql
      - ./docker/mariadb.cnf:/etc/mysql/conf.d/custom.cnf
      
      # Mount logs directory for easy access
      - ./logs/mariadb:/var/log/mysql
    
    # Environment for development
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: movies_db
      MYSQL_USER: movies_user
      MYSQL_PASSWORD: movies_password

volumes:
  mariadb_data:
    driver: local
